{"version":3,"sources":["webpack://react_ssr/./src/client/request.js","webpack://react_ssr/./src/components/Header/index.js","webpack://react_ssr/./src/containers/App.js","webpack://react_ssr/./src/containers/Counter/index.js","webpack://react_ssr/./src/containers/Home/index.js","webpack://react_ssr/./src/containers/NotFound/index.js","webpack://react_ssr/./src/containers/User/detail.js","webpack://react_ssr/./src/containers/User/index.js","webpack://react_ssr/./src/routes.js","webpack://react_ssr/./src/server/render.js","webpack://react_ssr/./src/server/request.js","webpack://react_ssr/./src/store/action-type.js","webpack://react_ssr/./src/store/actions/counter.js","webpack://react_ssr/./src/store/actions/home.js","webpack://react_ssr/./src/store/index.js","webpack://react_ssr/./src/store/reducers/counter.js","webpack://react_ssr/./src/store/reducers/home.js","webpack://react_ssr/./src/store/reducers/index.js","webpack://react_ssr/external \"@babel/runtime/helpers/asyncToGenerator\"","webpack://react_ssr/external \"@babel/runtime/regenerator\"","webpack://react_ssr/external \"axios\"","webpack://react_ssr/external \"koa\"","webpack://react_ssr/external \"koa-router\"","webpack://react_ssr/external \"koa-server-http-proxy\"","webpack://react_ssr/external \"koa-static\"","webpack://react_ssr/external \"react\"","webpack://react_ssr/external \"react-dom/server\"","webpack://react_ssr/external \"react-redux\"","webpack://react_ssr/external \"react-router-config\"","webpack://react_ssr/external \"react-router-dom\"","webpack://react_ssr/external \"redux\"","webpack://react_ssr/external \"redux-logger\"","webpack://react_ssr/external \"redux-thunk\"","webpack://react_ssr/webpack/bootstrap","webpack://react_ssr/webpack/runtime/compat get default export","webpack://react_ssr/webpack/runtime/define property getters","webpack://react_ssr/webpack/runtime/hasOwnProperty shorthand","webpack://react_ssr/webpack/runtime/make namespace object","webpack://react_ssr/./src/server/index.js"],"names":["axios","baseURL","Header","props","App","console","log","route","components","renderRoutes","routes","Counter","countHandler","number","add","connect","state","counter","actions","Home","useEffect","list","length","getHomeList","map","item","name","age","home","loadData","store","dispatch","NotFound","useLayoutEffect","group","UserDetail","User","path","component","exact","key","ctx","next","getServerStore","context","css","matchedRoutes","matchRoutes","promises","forEach","push","Promise","all","html","renderToString","cssStr","csses","join","body","JSON","stringify","getState","headers","cookies","get","ADD","SET_HOME_LIST","type","types","request","then","result","data","payload","getClientStore","initState","window","createStore","reducers","applyMiddleware","thunk","clientRequest","logger","serverRequest","action","combineReducers","app","Koa","router","KoaRouter","use","proxy","target","pathRewrite","changeOrigin","koaStatic","process","cwd","render","listen"],"mappings":"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","file":"server.js","sourcesContent":["import axios from 'axios';\r\nexport default axios.create({\r\n    baseURL: '/'\r\n})","import React,{Fragment} from 'react';\r\nimport {Link} from 'react-router-dom';\r\n\r\nconst Header = (props)=>{\r\n  return(\r\n    <Fragment>\r\n      <div>\r\n        <ul>\r\n          <li>\r\n            <Link to=\"/\">Home</Link>\r\n          </li>\r\n          <li>\r\n            <Link to=\"/counter\">Counter</Link>\r\n          </li>\r\n          <li>\r\n            <Link to=\"/user\">user</Link>\r\n          </li>\r\n          <li>\r\n            <Link to=\"/user/detail\">detail</Link>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default Header","import React,{Fragment} from 'react';\r\nimport {renderRoutes} from 'react-router-config';\r\nimport Header from '../components/Header'\r\nlet App = (props)=>{\r\n    console.log(props.route.components)\r\n    return(\r\n        <Fragment>\r\n            <Header />\r\n            {renderRoutes(props.route.routes)}\r\n          </Fragment>\r\n    )\r\n}\r\nexport default App;","import React,{useState} from 'react';\r\nimport {connect} from 'react-redux'\r\nimport actions from '../../store/actions/counter'\r\nconst Counter = (props)=>{\r\n  // const [number,setNumber] = useState(0)\r\n  const countHandler = ()=>{\r\n    console.log(111)\r\n    \r\n  }\r\n  return(\r\n    <div>\r\n        <p>{props.number}</p>\r\n      <button onClick={props.add}>+</button>\r\n    </div>\r\n  )\r\n}\r\nexport default connect((state)=>state.counter,actions)(Counter);","import React,{useEffect} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport actions from '../../store/actions/home';\r\n// class Home extends React.Component{\r\n//   componentDidMount(){\r\n//     this.props.getHomeList()\r\n//   }\r\n//   render(){\r\n//     return(\r\n//       <div>\r\n//         <ul>\r\n//           {props.list.map(item=>(\r\n//             <li key={item.name}>name:{item.name},age:{item.age}</li>\r\n//           ))\r\n//           }\r\n          \r\n//         </ul>\r\n//       </div>\r\n//     )\r\n//   }\r\n// }\r\nlet Home = (props)=>{\r\n  useEffect(()=>{\r\n    if(props.list.length==0){\r\n      props.getHomeList()\r\n    }\r\n    \r\n  },[])\r\n  return(\r\n    <div>\r\n      <ul>\r\n        {props.list.map(item=>(\r\n          <li key={item.name}>name:{item.name},age:{item.age}</li>\r\n        ))\r\n        }\r\n        \r\n      </ul>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n//此方法用来异步加载数据，将数据放到仓库中去\r\nHome = connect(state=>state.home,actions)(Home)\r\nHome.loadData = function(store){\r\n  console.log('store--',store)\r\n  // dispatch 派发的 就是一个action  return store.dispatch =>  return axios.get()  是一个promise\r\n   return store.dispatch(actions.getHomeList())\r\n}\r\n// Home = \r\nexport default Home;","import React,{useEffect,useContext,useLayoutEffect} from 'react';\r\nlet NotFound = (props)=>{\r\n    useLayoutEffect(()=>{\r\n        console.group('props2',props)\r\n    return ()=>{\r\n        console.group('props2',props)\r\n    }\r\n  },[])\r\n  return(\r\n    <div>\r\n      404\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default NotFound;","import React, { Fragment } from 'react';\r\nconst UserDetail = () => {\r\n  return (\r\n    <div>user d</div>\r\n  )\r\n}\r\nexport default UserDetail","import React, { Fragment } from 'react';\r\nconst User = ()=>{\r\n  return(\r\n    <div>user list</div>\r\n  )\r\n}\r\nexport default User","import React, { Fragment } from 'react';\r\nimport { Route } from 'react-router-dom';\r\nimport Home from './containers/Home';\r\nimport Counter from './containers/Counter';\r\nimport User from './containers/User/index';\r\nimport UserDetail from './containers/User/detail';\r\nimport App from './containers/App';\r\nimport NotFound from './containers/NotFound';\r\nexport default [\r\n  {\r\n    path:'/',\r\n    component:App,\r\n\r\n    routes:[\r\n      {\r\n        path: '/',\r\n        component: Home,\r\n        exact: true,\r\n        key: 'home',\r\n        loadData: Home.loadData//服务端渲染需要加载异步数据\r\n      },\r\n      {\r\n        path: '/counter',\r\n        component: Counter,\r\n        key: 'login',\r\n      },\r\n      {\r\n        component: NotFound,\r\n        key: 'notfound',\r\n      },\r\n      // {\r\n      //   path: '/user',\r\n      //   component: User,\r\n      //   key: '/user',\r\n        \r\n      //   routes: [\r\n      //     {\r\n      //       path: '/user/detail',\r\n      //       component: UserDetail,\r\n      //       key: '/user/detail',\r\n      //       exact: true,\r\n      //     }\r\n      //   ]\r\n      // },\r\n    ]\r\n  }\r\n]\r\n// export default (\r\n//   <Fragment>\r\n//     <Route path=\"/\" exact component={Home}></Route>\r\n//     <Route path=\"/counter\" exact component={Counter}></Route>\r\n//   </Fragment>\r\n// )","import React, { Fragment } from 'react';\r\nimport { renderToString } from 'react-dom/server';\r\nimport { StaticRouter, Route, matchPath } from 'react-router-dom'\r\nimport routes from '../routes';\r\nimport { renderRoutes,matchRoutes } from 'react-router-config';\r\nimport { Provider } from 'react-redux'\r\nimport { getServerStore } from '../store';\r\n\r\nexport default async function (ctx,next) {\r\n  let store = getServerStore(ctx);\r\n  let context = {css:[]}\r\n  let matchedRoutes = matchRoutes(routes,ctx.path)\r\n  let promises=[];\r\n  matchedRoutes.forEach(item => {\r\n    if (item.route.loadData) {\r\n       promises.push(item.route.loadData(store))\r\n    }\r\n  })\r\n    await Promise.all(promises);\r\n    let html = renderToString(\r\n      <Provider store={store}>\r\n        <StaticRouter context={context} location={ctx.path}>\r\n          \r\n          {renderRoutes(routes)}\r\n        </StaticRouter>\r\n      </Provider>\r\n  \r\n    )\r\n  let cssStr = context.css.length>0 && context.csses.join('\\n');\r\n    ctx.body = `\r\n      <!DOCTYPE html>\r\n        <html lang=\"en\">\r\n        <head>\r\n          <meta charset=\"UTF-8\">\r\n          <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\r\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n          <title>Document</title>\r\n          <style>${cssStr}</style>\r\n        </head>\r\n        <body>\r\n            <div id=\"root\">${html}</div>\r\n            <script>\r\n              window.context = {\r\n                state:${JSON.stringify(store.getState())}\r\n              }\r\n            </script>\r\n            <script src=\"/index.js\"></script>\r\n        </body>\r\n        </html>\r\n    `\r\n}","import axios from 'axios';\r\nexport default (ctx)=> axios.create({\r\n    baseURL: 'http://localhost:8081/',\r\n    headers:{\r\n        cookies:ctx.cookies.get('cookie')||''\r\n    }\r\n})","export const ADD = 'ADD';\r\nexport const SET_HOME_LIST = 'SET_HOME_LIST';","import * as types from '../action-type';\r\nexport default {\r\n  add(){\r\n    return {type:types.ADD}\r\n  }\r\n}","import * as types from '../action-type';\r\nimport axios from 'axios'\r\nexport default {\r\n    getHomeList(){\r\n        //返回一个函数  store.dispatch(action)\r\n\r\n        \r\n        return function(dispatch,getState,request){ //redux-thunk 中间件\r\n            // return Promise.resolve(\r\n            //     dispatch({\r\n            //         type: types.SET_HOME_LIST,\r\n            //         payload: [{name:123,age:18}]\r\n            //     })\r\n            // )\r\n            return request.get('/api/users').then(result=>{\r\n                // console.log(result)\r\n                let list  = result.data;\r\n                dispatch({\r\n                    type:types.SET_HOME_LIST,\r\n                    payload:list\r\n                })\r\n            })\r\n        }\r\n    }\r\n}","import { createStore, applyMiddleware } from 'redux';\r\nimport thunk from 'redux-thunk';\r\nimport logger from 'redux-logger';\r\nimport reducers from './reducers';\r\nimport clientRequest from '../client/request';\r\nimport serverRequest from '../server/request';\r\nexport function getClientStore() {\r\n  let initState = window.context.state;\r\n  return createStore(reducers, initState, applyMiddleware(thunk.withExtraArgument(clientRequest), logger))\r\n}\r\nexport function getServerStore(ctx) {\r\n\r\n  return createStore(reducers, applyMiddleware(thunk.withExtraArgument(serverRequest(ctx)), logger))\r\n}","import * as type from '../action-type';\r\nlet initState = {number:0}\r\nexport default function(state=initState,action){\r\n  switch (action.type) {\r\n    case type.ADD:\r\n      return {number:state.number+1}\r\n    default:\r\n      return state\r\n  }\r\n}","import * as type from '../action-type';\r\nlet initState = {list:[]}\r\nexport default function(state=initState,action){\r\n  switch (action.type) {\r\n    case type.SET_HOME_LIST:\r\n      return { list: action.payload }\r\n    default:\r\n      return state\r\n  }\r\n}","import {combineReducers} from 'redux';\r\nimport counter from './counter';\r\nimport home from './home';\r\n\r\nconst reducers = combineReducers({\r\n  counter,\r\n  home\r\n})\r\nexport default reducers;","module.exports = require(\"@babel/runtime/helpers/asyncToGenerator\");;","module.exports = require(\"@babel/runtime/regenerator\");;","module.exports = require(\"axios\");;","module.exports = require(\"koa\");;","module.exports = require(\"koa-router\");;","module.exports = require(\"koa-server-http-proxy\");;","module.exports = require(\"koa-static\");;","module.exports = require(\"react\");;","module.exports = require(\"react-dom/server\");;","module.exports = require(\"react-redux\");;","module.exports = require(\"react-router-config\");;","module.exports = require(\"react-router-dom\");;","module.exports = require(\"redux\");;","module.exports = require(\"redux-logger\");;","module.exports = require(\"redux-thunk\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\r\nimport Koa from 'koa';\r\nimport KoaRouter from 'koa-router';\r\nimport koaStatic from 'koa-static';\r\nimport render from './render';\r\nimport proxy from 'koa-server-http-proxy';\r\nconst app = new Koa();\r\nlet router = new KoaRouter()\r\n\r\napp.use(proxy(\"/api\",{\r\n  target:\"http://localhost:8081\",\r\n  pathRewrite:{'^/api':'/api'},\r\n  changeOrigin:true\r\n}));\r\n\r\napp.use(koaStatic(process.cwd() + '/public'))\r\napp.use(async (ctx,next)=>{\r\n  if(ctx.path!='/favicon.ico'){\r\n    await render(ctx,next)\r\n  }\r\n  \r\n})\r\n\r\n// app.use(router.routes())\r\n// app.use(router.allowedMethods());\r\n// console.log(process.cwd())\r\n\r\napp.listen(8080, function () {\r\n  console.log('start')\r\n})"],"sourceRoot":""}